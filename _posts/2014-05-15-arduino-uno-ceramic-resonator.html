---
layout: post
title: Arduino Uno Ceramic Resonator
date: '2014-05-15T15:34:00.001+01:00'
author: jimbuzz
tags: 
modified_time: '2014-05-19T10:02:28.680+01:00'
thumbnail: http://1.bp.blogspot.com/-1pGG0b-RFZo/U3Ti2lPlJpI/AAAAAAAABQ4/rLpaqs-SY_I/s72-c/photo+2.JPG
blogger_id: tag:blogger.com,1999:blog-4676883399643590331.post-6725305188553235182
blogger_orig_url: http://parkyjimbo.blogspot.com/2014/05/arduino-uno-ceramic-resonator.html
---

I was using an Arduino Uno to measure the PPS (pulse per second) pin from a GPS module to allow comparison with the PPS from a DS1307 RTC real time clock. I used interrupts 0 and 1 of the Arduino to trigger on rising edges of both PPS pins to trigger a reading from the micros() function and then subtract this reading from a subsequent micros() reading taken on the next rising edge so giving me a measure of the pulse width in microseconds, give or take four microseconds. Apparently the misnamed micros() function cannot make one microsecond measurements. Using this setup I was able to see that the 16MHz clock on the Arduino was out compared to the GPS PPS pin which from the datasheet was accurate to the tens of nano seconds range. The measured error I found was due to the Arduino using a resonator for its system clock, known for not being as accurate a crystal. The strange thing is there is already a crystal on the board for the USB serial chip, probably for accurate baud rates, it is 16MHz the value we need. I removed the resonator for the ATMega328P from the board and made a direct connection from the crystal oscillator output of the USB serial chip to the oscillator input of the ATMega328P. The board can still be programmed and now has a more accurate system clock for my measurements. I wonder if this is something that could be done to the Arduino to save the cost of a resonator. I eventually moved my sketch to a Stellaris Launchpad which has an 80MHz clock and can measure down to one microsecond with its appropriately named&nbsp; micros() function.<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-1pGG0b-RFZo/U3Ti2lPlJpI/AAAAAAAABQ4/rLpaqs-SY_I/s1600/photo+2.JPG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://1.bp.blogspot.com/-1pGG0b-RFZo/U3Ti2lPlJpI/AAAAAAAABQ4/rLpaqs-SY_I/s1600/photo+2.JPG" height="239" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">16MHz Resonator removed, center of PCB</td></tr></tbody></table><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-U2rsmsluX1s/U3Ti7lRmamI/AAAAAAAABRA/E6CBXIdpKa8/s1600/photo+1.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://4.bp.blogspot.com/-U2rsmsluX1s/U3Ti7lRmamI/AAAAAAAABRA/E6CBXIdpKa8/s1600/photo+1.jpg" height="239" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">16MHz Osc Output of ATMega8U2 connected to ATMeg328P Osc input</td></tr></tbody></table>